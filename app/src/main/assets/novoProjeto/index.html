<!DOCTYPE html>
<html>
  <head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>interface</title>
	<script src="engine.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/ace/1.32.3/ace.js"></script>
  </head>
<style>
  html {
    background-color: darkgrey;
  }
  #barraUtils {
    background: dimgrey;
  }
  #jogo {
    background: black;
  }
  #editor {
    position: absolute;
    left: 10px;
    top: 350px;
    width: 550px;
    height: 300px;
    border: 1px solid #444;
    box-sizing: border-box;
  }
  #editorAce {
    width: 100%;
    height: 100%;
    font-size: 14px;
  }
</style>
  <body>
	<div id="barraUtils">
	  <button onClick="executar()">rodar</button>
	  <button onClick="salvar()">salvar</button>
	  <input id="arqSele" type="text" value="jogo.js">
	  <button onClick="abrir()">abrir</button>
	</div>
	<div>
	  <canvas id="jogo" width="550" height="300"></canvas>
	</div>
	<div id="editor">
	  <div id="editorAce"></div>
	</div>

<script>
    const engine = new Engine(null, true, false);

    const editor = ace.edit("editorAce");
    editor.setTheme("ace/theme/monokai");
    editor.session.setMode("ace/mode/javascript");

    abrir();

    function salvar() {
      let arquivo = document.getElementById("arqSele").value.trim();
      Android.arquivar(arquivo, editor.getValue());
      Android.msg("projeto salvo em: " + arquivo);
      editor.setValue(Android.ler(arquivo), -1);
    }

    function abrir() {
      let arquivo = document.getElementById("arqSele").value.trim();
      editor.setValue(Android.ler(arquivo), -1);
      Android.msg("arquivo aberto");
    }

    function executar() {
      let codigo = editor.getValue();
      engine.limpar();
      eval(codigo);
      Android.msg("rodando");
    }
</script>
	<script src="jogo.js"></script>
  </body>
</html>
